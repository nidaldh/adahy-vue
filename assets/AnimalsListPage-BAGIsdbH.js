import{d as T,r as v,q as p,s as x,c as a,a as s,y as S,f as g,v as z,A as h,F as L,i as N,B as I,m as V,t as u,I as D,h as n,n as R,_ as U,p as K,o as E,b as Q}from"./index-D2cXNYYD.js";const W={class:"animals-table-container",dir:"rtl"},j={class:"controls-section"},G={class:"search-controls"},H={class:"search-group"},J={class:"filter-group"},O=["value"],X={class:"summary-info"},Y={class:"summary-item"},Z={class:"summary-item"},tt={class:"table-responsive"},st={class:"sort-options"},et={class:"animals-table"},lt={class:"number"},ot={class:"notes-cell"},at={key:0,class:"notes-content"},nt={key:1,class:"no-notes"},it={class:"customer-name"},ut={class:"actions"},rt=["onClick","title"],dt={key:0,class:"pagination-container"},ct={class:"pagination"},vt=["disabled"],pt=["disabled"],ft={class:"page-info"},mt=["disabled"],gt=["disabled"],bt={class:"page-size-selector"},yt={key:1,class:"empty-state"},_t={key:0},Ct={key:1},kt=T({__name:"AnimalsTable",props:{animals:{},loading:{type:Boolean}},setup(A){const d=A,$=D(),r=v(""),c=v(""),i=v(""),b=v("type"),w=v("asc"),o=v(1),f=v(50),B=p(()=>{const l=new Set(d.animals.map(t=>t.type));return Array.from(l).sort((t,e)=>t.localeCompare(e,"ar"))}),y=p(()=>{let l=[...d.animals];if(r.value.trim()){const t=r.value.toLowerCase().trim();l=l.filter(e=>e.compositeKey.toLowerCase().includes(t)||e.type.toLowerCase().includes(t)||e.number.toLowerCase().includes(t)||e.notes&&e.notes.toLowerCase().includes(t)||e.customerName.toLowerCase().includes(t))}return c.value&&(l=l.filter(t=>t.type===c.value)),i.value&&(l=l.filter(t=>t.status===i.value)),l.sort((t,e)=>{const m=t[b.value],C=e[b.value];let k=0;return typeof m=="string"&&typeof C=="string"?k=m.localeCompare(C,"ar"):typeof m=="number"&&typeof C=="number"?k=m-C:k=String(m).localeCompare(String(C),"ar"),w.value==="asc"?k:-k}),l}),_=p(()=>Math.ceil(y.value.length/f.value)),F=p(()=>{const l=(o.value-1)*f.value,t=l+f.value;return y.value.slice(l,t)}),M=p(()=>y.value.reduce((l,t)=>l+t.weight,0)),P=l=>{switch(l){case"حي":return"status-alive";case"جاهز":return"status-ready";case"مذبوح":return"status-slaughtered";case"ملغي":return"status-cancelled";default:return""}},q=(l,t)=>{const e={customerId:l};t&&(e.highlightAnimalId=t),$.push({name:"CustomerRelationships",query:e})};return x([r,c,i],()=>{o.value=1}),x(f,()=>{o.value=1}),x([b,w],()=>{o.value=1}),(l,t)=>(n(),a("div",W,[s("div",j,[s("div",G,[s("div",H,[g(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),type:"text",placeholder:"البحث بالنوع، الرقم، الملاحظات، أو اسم العميل...",class:"search-input"},null,512),[[z,r.value]]),t[11]||(t[11]=s("i",{class:"fas fa-search search-icon"},null,-1))]),s("div",J,[g(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e),class:"filter-select"},[t[12]||(t[12]=s("option",{value:""},"جميع الأنواع",-1)),(n(!0),a(L,null,N(B.value,e=>(n(),a("option",{key:e,value:e},u(e),9,O))),128))],512),[[h,c.value]]),g(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>i.value=e),class:"filter-select"},t[13]||(t[13]=[I('<option value="" data-v-c6f5c26c>جميع الحالات</option><option value="حي" data-v-c6f5c26c>حي</option><option value="جاهز" data-v-c6f5c26c>جاهز</option><option value="مذبوح" data-v-c6f5c26c>مذبوح</option><option value="ملغي" data-v-c6f5c26c>ملغي</option>',5)]),512),[[h,i.value]])])]),s("div",X,[s("span",Y,[t[14]||(t[14]=s("i",{class:"fas fa-list-ol"},null,-1)),V(" إجمالي الأضاحي: "+u(y.value.length),1)]),s("span",Z,[t[15]||(t[15]=s("i",{class:"fas fa-calculator"},null,-1)),V(" إجمالي الوزن: "+u(M.value.toFixed(2))+" كجم ",1)])])]),s("div",tt,[s("div",st,[t[18]||(t[18]=s("label",null,"ترتيب حسب:",-1)),g(s("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>b.value=e),class:"sort-select"},t[16]||(t[16]=[I('<option value="type" data-v-c6f5c26c>النوع</option><option value="number" data-v-c6f5c26c>الرقم</option><option value="weight" data-v-c6f5c26c>الوزن</option><option value="status" data-v-c6f5c26c>الحالة</option><option value="notes" data-v-c6f5c26c>الملاحظات</option><option value="customerName" data-v-c6f5c26c>اسم العميل</option><option value="compositeKey" title="ترتيب فريد يجمع بين النوع والرقم" data-v-c6f5c26c>المفتاح المركب (النوع_الرقم)</option>',7)]),512),[[h,b.value]]),g(s("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>w.value=e),class:"sort-select"},t[17]||(t[17]=[s("option",{value:"asc"},"تصاعدي",-1),s("option",{value:"desc"},"تنازلي",-1)]),512),[[h,w.value]])]),s("table",et,[t[20]||(t[20]=s("thead",null,[s("tr",null,[s("th",null,"النوع"),s("th",null,"الرقم"),s("th",null,"الوزن (كجم)"),s("th",null,"الحالة"),s("th",null,"الملاحظات"),s("th",null,"اسم العميل"),s("th",null,"إجراءات")])],-1)),s("tbody",null,[(n(!0),a(L,null,N(F.value,e=>(n(),a("tr",{key:`${e.customerId}-${e.id}`},[s("td",null,u(e.type),1),s("td",null,u(e.number),1),s("td",lt,u(e.weight.toFixed(2)),1),s("td",null,[s("span",{class:R(["status-badge",P(e.status)])},u(e.status),3)]),s("td",ot,[e.notes?(n(),a("span",at,u(e.notes),1)):(n(),a("span",nt,"-"))]),s("td",it,u(e.customerName),1),s("td",ut,[s("button",{onClick:m=>q(e.customerId,e.id),class:"btn btn-info btn-sm",title:`عرض تفاصيل العميل ${e.customerName}`},t[19]||(t[19]=[s("i",{class:"fas fa-info-circle"},null,-1),V(" تفاصيل ")]),8,rt)])]))),128))])])]),_.value>1?(n(),a("div",dt,[s("div",ct,[s("button",{onClick:t[5]||(t[5]=e=>o.value=1),disabled:o.value===1,class:"btn btn-sm"},t[21]||(t[21]=[s("i",{class:"fas fa-angle-double-right"},null,-1)]),8,vt),s("button",{onClick:t[6]||(t[6]=e=>o.value--),disabled:o.value===1,class:"btn btn-sm"},t[22]||(t[22]=[s("i",{class:"fas fa-angle-right"},null,-1)]),8,pt),s("span",ft," صفحة "+u(o.value)+" من "+u(_.value),1),s("button",{onClick:t[7]||(t[7]=e=>o.value++),disabled:o.value===_.value,class:"btn btn-sm"},t[23]||(t[23]=[s("i",{class:"fas fa-angle-left"},null,-1)]),8,mt),s("button",{onClick:t[8]||(t[8]=e=>o.value=_.value),disabled:o.value===_.value,class:"btn btn-sm"},t[24]||(t[24]=[s("i",{class:"fas fa-angle-double-left"},null,-1)]),8,gt)]),s("div",bt,[t[26]||(t[26]=s("label",null,"عدد الصفوف:",-1)),g(s("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>f.value=e),onChange:t[10]||(t[10]=e=>o.value=1)},t[25]||(t[25]=[s("option",{value:25},"25",-1),s("option",{value:50},"50",-1),s("option",{value:100},"100",-1),s("option",{value:200},"200",-1)]),544),[[h,f.value]])])])):S("",!0),y.value.length===0?(n(),a("div",yt,[t[27]||(t[27]=s("i",{class:"fas fa-search fa-3x"},null,-1)),t[28]||(t[28]=s("h3",null,"لا توجد أضاحي",-1)),r.value||c.value||i.value?(n(),a("p",_t," لا توجد نتائج تطابق معايير البحث الحالية ")):(n(),a("p",Ct," لا توجد أضاحي مسجلة في النظام حالياً "))])):S("",!0)]))}}),ht=U(kt,[["__scopeId","data-v-c6f5c26c"]]),wt={class:"animals-list-page",dir:"rtl"},Vt={key:0,class:"loading-container"},$t={key:1,class:"page-content"},xt=T({__name:"AnimalsListPage",setup(A){const d=K(),$=p(()=>d.allAnimals),r=p(()=>d.loading);return E(async()=>{d.customers.length===0&&!d.loading&&await d.fetchCustomers()}),(c,i)=>(n(),a("div",wt,[i[1]||(i[1]=s("div",{class:"page-header"},[s("h2",null,[s("i",{class:"fas fa-list"}),V(" قائمة الأضاحي ")]),s("p",{class:"page-description"}," جميع الأضاحي مرتبة حسب النوع والرقم المركب ")],-1)),r.value?(n(),a("div",Vt,i[0]||(i[0]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"جاري التحميل...")],-1),s("p",null,"جاري تحميل البيانات...",-1)]))):(n(),a("div",$t,[Q(ht,{animals:$.value,loading:r.value},null,8,["animals","loading"])]))]))}}),St=U(xt,[["__scopeId","data-v-3041ecfc"]]);export{St as default};
